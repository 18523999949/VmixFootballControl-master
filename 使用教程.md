# Vmix足球比赛控制面板 - 简易使用教程

## 📋 目录
1. [快速开始](#快速开始)
2. [基本操作](#基本操作)
3. [CSV文件说明](#csv文件说明)
4. [常见问题](#常见问题)

---

## 快速开始

### 1. 运行程序
- 双击运行 `足球字幕控制系统v2502030302.exe`
- 或运行Python脚本：`python a0.95.py`

### 2. 连接vMix
1. 启动vMix软件
2. 点击左侧菜单的 **"[连接]"** → 点击 **"连接vMix"**
3. 默认连接地址：`127.0.0.1:8099`

### 3. 设置球队
1. 点击 **"[设置]"** 按钮
2. 设置主队/客队名称和颜色
3. 准备球队名单文件：
   - `home.txt`（主队名单）
   - `away.txt`（客队名单）
   - 格式：`号码,姓名`（每行一个球员）

---

## 基本操作

### 📊 记分板
- 位置：左上角
- 操作：点击 `+`/`-` 调整比分，下拉菜单切换比赛时段

### 👥 球队名单
- 点击 **"[名单]"** 查看球员列表
- 修改 `home.txt` 或 `away.txt` 后重启程序更新

### 🔄 换人管理
1. 点击 **"[换人]"** 菜单
2. 输入格式：`22 34` 或 `22,34`（换下号码 换上号码）
3. 点击 **"上字幕"** 发送到vMix

### 🟨🟥 红黄牌
1. 点击 **"[牌]"** 菜单
2. 输入球员号码
3. 点击 **"红牌"** 或 **"黄牌"** 按钮
4. 点击 **"上字幕"** 发送

### ⚽ 进球管理
1. 点击 **"[进球]"** 菜单
2. 输入进球球员号码
3. 点击 **"上字幕"** 发送
4. 比分会自动更新

---

## CSV文件说明

系统自动保存比赛数据到CSV文件，所有文件使用UTF-8编码，位于程序目录下。

| 文件名 | 用途 | 格式示例 |
|--------|------|----------|
| **scoreboard.csv** | 比分板数据 | `重庆,2,#10EFDE`<br>`上海,1,#D93131`<br>`下半场` |
| **goal.csv** | 进球记录 | `重庆,24,刘卫东`<br>`上海,22,王刚` |
| **red_card.csv** | 红牌记录 | `重庆,24,刘卫东`<br>`上海,22,王刚` |
| **yellow_card.csv** | 黄牌记录 | `重庆,24,刘卫东`<br>`重庆,25,陈安琪` |
| **substitutions.csv** | 换人记录 | `重庆,24,刘卫东`（换下）<br>`重庆,25,陈安琪`（换上） |

**重要提示**：
- 程序启动时会**清空**事件记录文件（goal.csv, red_card.csv, yellow_card.csv, substitutions.csv）
- `substitutions.csv` 每次换人占**两行**（第一行换下，第二行换上）
- 所有文件使用逗号分隔，可用Excel或文本编辑器打开

---

## 常见问题

### Q1: 无法连接到vMix？
- 确保vMix软件已启动
- 检查vMix的API设置（Settings → API & Web）
- 确认IP和端口是否正确（默认127.0.0.1:8099）

### Q2: 字幕没有显示？
- 检查vMix中的输入层编号是否正确
- 确认对应的输入有字幕模板
- 尝试手动点击"上字幕"按钮测试

### Q3: CSV文件数据丢失？
- **程序启动时会自动清空**事件记录文件
- 如需保留数据，请在程序运行期间备份CSV文件

### Q4: 如何修改球队名单？
- 编辑 `home.txt`（主队）或 `away.txt`（客队）
- 格式：`号码,姓名`（每行一个球员）
- 保存后重启程序

---

## 📝 注意事项

1. 程序启动时会清空事件记录，请及时备份重要数据
2. 修改 `config.json` 后需要重启程序才能生效
3. CSV文件使用UTF-8编码，可用Excel或文本编辑器打开
4. 如果vMix在其他电脑上，需要修改IP地址

---

**版本**：v0.95
